<UserControl
    x:Class="DynamicUniform.RanksLayout"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:DynamicUniform"
    d:DesignHeight="450"
    d:DesignWidth="800"
    d:DataContext="{d:DesignInstance local:RanksLayout}"
    Background="Transparent"
    mc:Ignorable="d">
    <UserControl.Resources>
        <PathGeometry
            x:Key="TreeArrow"
            Figures="M508.893248 762.931659a65.039498 65.039498 0 0 1-46.420659-19.485839L97.125746 371.004022c-25.143018-25.634319-24.752868-66.816849 0.881451-91.959868 25.648769-25.164693 66.809624-24.745643 91.959867 0.881451l318.933409 325.125238 318.933408-325.125238a65.025048 65.025048 0 0 1 92.841318 91.078417L555.313907 743.44582a65.025048 65.025048 0 0 1-46.420659 19.485839z" />
    </UserControl.Resources>

    <Grid>
        <Border
            x:Name="ReferenceTarget" Height="30" Padding="10,0"
            CornerRadius="4" Cursor="Hand" PreviewMouseUp="ReferenceTarget_OnPreviewMouseUp">
            <StackPanel
                VerticalAlignment="Center" Orientation="Horizontal">
                <TextBlock
                    Margin="0,0,4,0" FontSize="16" Foreground="#FFFFFF"
                    Text="序列" />
                <Image
                    x:Name="LayoutImage" Width="18" Height="18"
                    VerticalAlignment="Center" Stretch="Fill">
                </Image>
                <Path
                    Width="12" Height="12" Margin="10,0,0,0"
                    Stretch="Uniform"
                    Data="{StaticResource TreeArrow}"
                    Fill="#FFFFFF">
                </Path>
            </StackPanel>
            <Border.Style>
                <Style TargetType="Border">
                    <Setter Property="Background" Value="Transparent">
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#4D4D4D" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
        </Border>

        <Popup
            x:Name="PopupSelect"
            PlacementTarget="{Binding ElementName=ReferenceTarget}"
            VerticalOffset="2" StaysOpen="False" Placement="Bottom">
            <Border
                Margin="0" Padding="0" BorderThickness="1"
                BorderBrush="#FFFFFF" Background="#424242">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Border
                        Grid.Row="0" Height="60" Padding="5,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Image
                                Grid.Column="0" Width="20" Height="20"
                                Stretch="Fill" Cursor="Hand" MouseUp="Layout1x1_OnMouseUp"
                                Source="{StaticResource DrawingImage.1*1DrawingImage}" />
                            <Image
                                Grid.Column="1" Width="20" Height="20"
                                Cursor="Hand" Stretch="Fill" MouseUp="Layout2x2_OnMouseUp"
                                Source="{StaticResource DrawingImage.2*2DrawingImage}" />
                            <Image
                                Grid.Column="2" Width="20" Height="20"
                                Cursor="Hand" Stretch="Fill" MouseUp="Layout3x3_OnMouseUp"
                                Source="{StaticResource DrawingImage.3*3DrawingImage}" />
                            <Image
                                Grid.Column="3" Width="20" Height="20"
                                Cursor="Hand" Stretch="Fill" MouseUp="Layout4x4_OnMouseUp"
                                Source="{StaticResource DrawingImage.4*4DrawingImage}" />
                        </Grid>
                    </Border>

                    <Border
                        x:Name="BorderContainer" Grid.Row="1" Margin="0,2,0,0"
                        Padding="2" BorderThickness="0,1,0,0" BorderBrush="#FFFFFF"
                        Background="#828282">
                        <ItemsControl
                            x:Name="ItemsContainer" Width="210" Height="210"
                            ItemsSource="{Binding GridCells}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <UniformGrid
                                        Rows="6" Columns="6" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border
                                        Margin="1"
                                        Background="{Binding BackgroundColor}">
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Border>
                </Grid>
            </Border>
        </Popup>
    </Grid>
</UserControl>
